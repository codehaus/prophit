<html>

<head>
<title>hprof</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="stylesheet" href="default.css" type="text/css">
</head>

<body class="normal" bgcolor="#FFFFFF" text="#000000">
<h1 align="center"><code>hprof</code></h1>
<table border="0" cellspacing="0" cellpadding="0" bgcolor="eeeeee">
  <tr> 
    <td width="179" nowrap>Previous : <a href="dash-prof.html">Java <code>-prof</code></a></td>
    <td width="20" bgcolor="ffffff" nowrap>&nbsp;</td>
    <td width="157" nowrap>Up : <a href="profiler-types.html">Profiler Types</a></td>
    <td width="20" bgcolor="ffffff" nowrap>&nbsp;</td>
    <td width="234" nowrap>Next : </td>
  </tr>
</table>
<p>Originally shipping with JDK 1.3 (and also available with JDK 1.4), <code>hprof</code> 
  is essentially an upgrade to <code>-prof</code>. It is invoked from the Java 
  command line in a similar manner to <code>-prof</code>:</p>
<pre>	java -Xrunhprof:&lt;options&gt;
</pre>
<p><code>hprof</code> has quite a few options. Run <code>java -Xrunhprof:help</code> 
  for a listing of its options, and read the <b>Resources</b> listed below for 
  more information. Briefly, <code>hprof</code> is a native library that runs 
  in-process with the Java Virtual Machine. When the VM exits, it dumps out a 
  file which can contain one or more of the following types of data:</p>
<ul>
  <li>a heap dump for memory profiling and leak detection</li>
  <li>monitor (lock) contention</li>
  <li>CPU timing information</li>
</ul>
<p>Orbit only reads the CPU timing information. CPU timing can be gathered by 
  specifying one of two options : <code>-Xrunhprof:cpu=samples</code>, or <code>-Xrunhprof:cpu=times</code>. 
  These two options are quite different. </p>
<h5>Sampling</h5>
<p>In <code>samples</code> mode, <code>hprof</code> spends the majority of the 
  time sleeping. Every few milliseconds, it wakes up and pauses the VM while it 
  looks at the current stack trace of each running thread. It keeps count of how 
  many times each stack traces occurs. The most common stack traces are the parts 
  of the program that were utilized the most. </p>
<h5>Timing</h5>
<p>In <code>times</code> mode, <code>hprof</code> keeps track of every single 
  function call that the Java program makes, adding up all the times spent in 
  each function. </p>
<h4>Advantages</h4>
<ul>
  <li>Built into the JDK</li>
  <li><code>cpu=samples</code> option does not dramatically slow down the JVM 
    the way that <code>-prof</code> and <code>cpu=times</code> do</li>
  <li>Can capture an arbitrary stack depth for accurate call graph data</li>
  <li>Correctly profiles multi-threaded applications</li>
</ul>
<h4>Disadvantages </h4>
<ul>
  <li>May require HotSpot to be disabled in order to function properly, especially 
    for multi-threaded programs running with JDK 1.3</li>
  <li><code>cpu=times</code> option is very slow</li>
  <li>Harder to learn than <code>-prof</code></li>
  <li><code>cpu=samples</code> is not accurate for programs which have very short 
    running times</li>
</ul>
<h4>Tips</h4>
<ul>
  <li>Specify <code>depth=6</code> or greater, to get better CPU data on functions 
    which may have many different callers. A good example is a program with database 
    access, such as the <a href="hsqldb-hprof-sample.html">HSQLDB sample profile</a>. 
  </li>
  <li>When running with JDK 1.3, specify the <code>java -classic</code> option 
    to turn off HotSpot.</li>
  <li>Don't specify <code>format=b</code> (binary output), Orbit can't read the 
    binary file data yet.</li>
  <li>Don't use <code>cpu=times</code>, except for profiling small, single-threaded 
    test programs</li>
</ul>
<a name="resources"><h4>Resources</h4></a>
<ul>
  <li><a href="http://www.javaworld.com/javaworld/jw-12-2001/jw-1207-hprof.html%20">http://www.javaworld.com/javaworld/jw-12-2001/jw-1207-hprof.html 
    </a></li>
  <li>Documentation for the <a href="http://java.sun.com/j2se/1.3/docs/tooldocs/win32/java.html">Java 
    1.3 Interpreter</a></li>
  <li>An interesting summary of various <a href="http://www.tarma.com/articles/index.htm#1997nov">profiling 
    methods</a>, including sampling and timing</li>
  <li>A Java Developer Connection <a href="http://developer.java.sun.com/developer/TechTips/2000/tt0124.html#tip2">Tech 
    Tip </a>on using <code>hprof</code></li>
  <li>An online <a href="http://tutorials.findtutorials.com/read/category/82/id/213/p/1">tutorial 
    </a>from FindTutorials</li>
  <li>HPjmeter performance analysis tool <a href="http://www.hp.com/products1/unix/java/hpjmeter/faq.html">FAQ</a></li>
</ul>
<table border="0" cellspacing="0" cellpadding="0" bgcolor="eeeeee">
  <tr> 
    <td width="179" nowrap>Previous : <a href="dash-prof.html">Java <code>-prof</code></a></td>
    <td width="20" bgcolor="ffffff" nowrap>&nbsp;</td>
    <td width="157" nowrap>Up : <a href="profiler-types.html">Profiler Types</a></td>
    <td width="20" bgcolor="ffffff" nowrap>&nbsp;</td>
    <td width="234" nowrap>Next : </td>
  </tr>
</table>
<h1>&nbsp;</h1>

</body>
</html>